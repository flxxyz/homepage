<!DOCTYPE html>
<html lang="zh">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" />
    <title>彩虹海是我哒 | 冯小贤</title>
    <link rel="stylesheet" href="https://cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="css/main.css">
    <link rel="stylesheet" href="css/like.css">
</head>

<body>
    <div class="nav">
        <div id="site-info">
            <span>&copy;冯小贤 2017.</span>
            <span>不知你在哪，但我会去找你，穷极一生找寻你，等着我，一起去寻找彩虹海!</span>
            <span>又拍云提供CDN服务,统计采用 <s>Google</s> Tongji-Baidu.</span>
            <span>大天朝身份证 = "鄂ICP备15022959号-3";</span>
        </div>
    </div>
    <div class="modern">
        <div class="row">
            <div class="bottom">
                <div>🌈 彩虹海是我哒</div>
            </div>
            <div class="bottom">
                <div><a href="https://blog.flxxyz.com" target="_blank">🏠 博客</a></div>
            </div>
            <div class="bottom">
                <div>等待添加</div>
            </div>
            <div class="bottom">
                <div>等待添加</div>
            </div>
        </div>
        <div class="row">
            <div class="top">
                <div>
                    <div class='like-vote'>
                        <p class='like-title'>Do you like me?</p>
                        <div class='like-count'>
                            <i class="fa fa-heart"></i><span id="count">0</span>
                        </div>
                    </div>
                </div>
            </div>
            <div class="top">
                <div>等待添加</div>
            </div>
            <div class="top">
                <div>等待添加</div>
            </div>
            <div class="top">
                <div>未完待续...</div>
            </div>
        </div>
        <video id="bg" autoplay>
        <source src="https://aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa.oss-cn-shanghai.aliyuncs.com/DAOKO-Forever_Friends.1080.mp4" type="video/mp4">
    </video>
    </div>
    <script src="https://cdn.bootcss.com/jquery/3.2.1/jquery.min.js"></script>
    <script src="https://cdn.bootcss.com/countup.js/1.9.3/countUp.min.js"></script>
    <script>
        $(function () {
            var h = $('.nav').height();
            $('#site-info').css({height: h}).append($('#site-info>span').first().clone());
            var tid = info_resize(h);

            var col = $('.row:nth-child(1)>div').length;
            var row = $('.row').length;

            resize(col, row);
            window.addEventListener('resize', function() {
                resize(col, row);
                clearInterval(tid);
                tid = info_resize(h);
            }, false);

            var c,data = {
                user: 'flxxyz',
                key: '81dc9bdb52d04dc20036dbd8313ed055'
            };
            var query = '?';
            for (var i in data) {
                query += i + '=' + data[i] + '&';
            }
            $.getJSON('https://like.toyou.ren/get' + query, function(data) {
                var like = data.count;
                c = new CountUp($('#count').get(0), 0, like, 0, 3, {
                    useEasing: false,
                    useGrouping: false,
                });
                if (!c.error) {
                    c.start();
                } else {
                    console.error(c.error);
                }
            });

            $('.like-vote').click(function(e) {
                $.post('https://like.toyou.ren/add', data, function(data) {
                    var like = data.count;
                    $('.like-count>span').text(like);
                    e = $('.like-title');
                    if (e.text() === 'Do you like me?') {
                        e.text('爱你哟(･ω<)☆');
                    } else if (e.text() === '爱你哟(･ω<)☆') {
                        e.text('我不搞基的( ꒪⌓꒪)');
                    }
                })
            });

            $('.like-count>span').get(0).addEventListener('DOMSubtreeModified', function() {
                like_resize();
            }, false);

            String.prototype.firstUpperCase = function() {
                return this.toLowerCase().replace(/( |^)[a-z]/g, (L) => L.toUpperCase());
            }

            function screen() {
                return {
                    width: $('body').width(),
                    height: $('body').height(),
                }
            }

            function like_resize() {
                var s = $('.like-count')
                var r = s.width() / 2
                s.css({ marginLeft: -r })
            }

            function info_resize(height, time) {
                time = (!time) ? 2000 : (time * 1000)

                var t = 0;
                var f = 0
                var span = $('#site-info>span')
                span.each(function(i, e) {
                    f += $(e).height()
                })

                return setInterval(function() {
                    span.each(function(i, e) {
                        if (t >= (f)) {
                            t = 0
                            span.each(function(i, e) {
                                $(e).css({ top: t })
                            })
                            t += height
                        }
                        $(e).animate({ top: -t })
                    })
                    t += height
                }, time)
            }

            function bg_resize() {
                var options = {
                    width: '100%',
                    height: '100%',
                    left: '0'
                }
                var s = screen()
                console.log((s.width / s.height).toFixed(5));

                // 差不多手机竖屏的样子
                if ((s.width / s.height).toFixed(5) < 1.77777) {
                    options.width = 'unset'
                    // options.left = '-50%'
                    $('#bg').css(options)
                }
                // pc与手机横屏
                if ((s.width / s.height).toFixed(5) > 1.77777) {
                    options.height = 'unset'
                    $('#bg').css(options)
                }
                // 最佳屏幕比
                if ((s.width / s.height).toFixed(5) == 1.77777) {
                    $('#bg').css(options)
                }
            }

            function row_item_resize() {
                var items = $('.row>div>div')
                items.each(function(i, e) {
                    var r = $(e).width() / 2
                    var options = {
                        left: '-50%',
                        // width: '100%',
                    }

                    $(e).css(options)
                })
            }

            function resize(col, row) {
                var s = screen()
                var rows = $('.row > div')
                var font_size = '2em';

                rows.each(function(i, e) {
                    var body = $('body').width()

                    if (body <= 1024) {
                        col = 2
                        row = 4
                    }

                    var row_width = ((s.width - (col * 2)) / col) + 'px'
                    var row_height = (((s.height - $('.nav').height()) - (row * 2)) / row) + 'px'
                    var options = {
                        width: row_width,
                        height: row_height,
                        lineHeight: row_height,
                        textAlign: 'center',
                    }

                    if (body >= 768) {
                        //$(e).attr('style', '-webkit-writing-mode:unset')
                        options.fontSize = font_size
                    } else if (body >= 375) {
                        options.fontSize = '1.2em'
                    } else {
                        options.fontSize = '1em'
                    }

                    $(e).css(options)
                })

                row_item_resize() // 调整item
                bg_resize() // 调整背景
                like_resize()
            }

            console.log("%c", "padding:50px;line-height:93px;background:url('https://static.flxxyz.com/img/2333.gif') no-repeat;");
            console.log("%cflxxyz.com", "text-shadow:0 1px 0 #ccc,0 2px 0 #c9c9c9,0 3px 0 #bbb,0 4px 0 #b9b9b9,0 5px 0 #aaa,0 6px 1px rgba(0,0,0,.1),0 0 5px rgba(0,0,0,.1),0 1px 3px rgba(0,0,0,.3),0 3px 5px rgba(0,0,0,.2),0 5px 10px rgba(0,0,0,.25),0 10px 10px rgba(0,0,0,.2),0 20px 20px rgba(0,0,0,.15);font-size:2em");
            console.log("%c video ", "color:#bada55;font-size:21px;");
            console.log("%cMV:", "color:red", "DAOKO-Forever_Friends");
            console.log("%c来源:", "color:red", "油管");
        })
    </script>
    <script>
        var _hmt = _hmt || [];
        (function() {
            var hm = document.createElement("script");
            hm.src = "https://hm.baidu.com/hm.js?1d0ea5d0fea464c6a0f97d94ab88f71e";
            var s = document.getElementsByTagName("script")[0];
            s.parentNode.insertBefore(hm, s);
        })();
    </script>
</body>

</html>